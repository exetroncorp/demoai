In a rootless Debian 12 environment with read-only `/etc`, you can use APT with custom configuration files by specifying them via command-line options and environment variables.

Here's how to do it:

## Basic Approach

```bash
# Create your custom config directory
mkdir -p /tmp/apt-config

# Create your custom sources.list
cat > /tmp/apt-config/sources.list << 'EOF'
deb http://deb.debian.org/debian bookworm main
deb http://deb.debian.org/debian bookworm-updates main
EOF

# Create your custom apt.conf
cat > /tmp/apt-config/apt.conf << 'EOF'
Dir::Etc::SourceList "/tmp/apt-config/sources.list";
Dir::Etc::SourceParts "";
Dir::State "/tmp/apt-state";
Dir::Cache "/tmp/apt-cache";
EOF

# If you need authentication, create auth.conf
cat > /tmp/apt-config/auth.conf << 'EOF'
machine example.com
login myuser
password mypass
EOF

# Create necessary directories
mkdir -p /tmp/apt-state/lists/partial
mkdir -p /tmp/apt-cache/archives/partial
```

## Using APT with Custom Config

```bash
# Update package lists
apt-get update \
  -c /tmp/apt-config/apt.conf \
  -o Dir::Etc::SourceList=/tmp/apt-config/sources.list \
  -o Dir::State=/tmp/apt-state \
  -o Dir::Cache=/tmp/apt-cache

# Download a package (without installing)
apt-get download <package-name> \
  -c /tmp/apt-config/apt.conf \
  -o Dir::Etc::SourceList=/tmp/apt-config/sources.list \
  -o Dir::State=/tmp/apt-state \
  -o Dir::Cache=/tmp/apt-cache
```

## Complete apt.conf Example

For a more comprehensive setup, use this apt.conf:

```bash
cat > /tmp/apt-config/apt.conf << 'EOF'
Dir::Etc::SourceList "/tmp/apt-config/sources.list";
Dir::Etc::SourceParts "";
Dir::State "/tmp/apt-state";
Dir::State::lists "/tmp/apt-state/lists";
Dir::Cache "/tmp/apt-cache";
Dir::Cache::archives "/tmp/apt-cache/archives";
Dir::Etc::TrustedParts "/tmp/apt-config/trusted.gpg.d";

# Authentication
Dir::Etc::netrc "/tmp/apt-config/auth.conf";

# Avoid privilege operations
APT::Sandbox::User "";
EOF
```

## Key Points

- **`-c` option**: Specifies the main config file
- **`-o` option**: Overrides specific configuration options
- **Dir::State**: Where APT stores package lists
- **Dir::Cache**: Where APT caches downloaded packages
- **Dir::Etc::netrc**: Path to your auth.conf for authenticated repositories

This approach allows you to completely bypass the read-only `/etc` and operate APT entirely from `/tmp` or any writable location.
